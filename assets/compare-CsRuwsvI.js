import{f as D,l as R,b as O,m as H}from"./data-CHqNZ0Rv.js";/* empty css              */import y from"./auto-CPGI3frw.js";function Y(){const e=document.documentElement.getAttribute("data-theme")==="dark";return{text:e?"#e0e0e0":"#666666",grid:e?"#3d4043":"#e5e7eb",title:e?"#ffffff":"#111111"}}function P(){const e=Y();y.defaults.color=e.text,y.defaults.borderColor=e.grid,y.defaults.plugins.title.color=e.title,y.defaults.plugins.legend.labels.color=e.text,y.defaults.scale.ticks.color=e.text,y.defaults.scale.title.color=e.text}P();const q=new MutationObserver(e=>{e.forEach(a=>{a.attributeName==="data-theme"&&(P(),I())})});q.observe(document.documentElement,{attributes:!0});const M={ai:"AI",vision:"Computer Vision",mlmining:"Machine Learning",nlp:"NLP",inforet:"Info Retrieval",arch:"Architecture",sec:"Security",mod:"Databases",da:"Design Automation",bed:"Embedded Systems",hpc:"HPC",mobile:"Mobile Computing",metrics:"Performance",ops:"Operating Systems",plan:"Programming Languages",soft:"Software Engineering",comm:"Networks",graph:"Graphics",act:"Algorithms",crypt:"Cryptography",log:"Logic & Verification",bio:"Comp. Biology",ecom:"Economics & Comp.",chi:"HCI",robotics:"Robotics",visualization:"Visualization",csed:"CS Education"};let S=null,L=null,x={},A={},k="us",u=new Date().getFullYear(),g=u-10,j=!1;async function W(){S=await R();try{const e="https://raw.githubusercontent.com/dynaroars/cspicks/main/public",[a,o,n]=await Promise.all([fetch(`${e}/professor_history_openalex.json`).then(t=>t.ok?t.json():null).catch(()=>null),fetch(`${e}/school-aliases.json`).then(t=>t.ok?t.json():null).catch(()=>null),O("./manual_affiliations.csv").catch(()=>[])]);A=o||{},x=H(a||{},n)}catch(e){console.warn("Could not load affiliation history or aliases",e)}z(),F(),U(),document.getElementById("loading-indicator").style.display="none",document.getElementById("filter-controls").style.display="flex",document.getElementById("compare-controls").style.display="flex"}function z(){const e=new Date().getFullYear(),a=document.getElementById("start-year"),o=document.getElementById("end-year");for(let n=e;n>=2e3;n--)a.add(new Option(n,n)),o.add(new Option(n,n));o.value=e,a.value=o.value-10,u=e,g=u-10}let d=[];function F(){const e=j?x:{},a=document.getElementById("conf-set")?.value||"csrankings",o=D(S,g,u,k,e,A,a);d=Object.values(o.schools).filter(l=>l.rank).sort((l,h)=>l.rank-h.rank),$("select-a","school-a"),$("select-b","school-b");const n=new URLSearchParams(window.location.search),t=n.get("schoolA"),s=n.get("schoolB");t&&d.find(l=>l.name===t)?v("select-a","school-a",t):d.length>=1&&v("select-a","school-a",d[0].name),s&&d.find(l=>l.name===s)?v("select-b","school-b",s):d.length>=2&&v("select-b","school-b",d[1].name),I()}function T(){const e=document.getElementById("school-a").value,a=document.getElementById("school-b").value;if(e&&a){const o=new URL(window.location);o.searchParams.set("schoolA",e),o.searchParams.set("schoolB",a),window.history.replaceState({},"",o)}}function $(e,a){const o=document.getElementById(e),n=o.querySelector(".search-input"),t=o.querySelector(".dropdown-list"),s=document.getElementById(a);C(t,d,s,n),n.addEventListener("focus",()=>{t.classList.add("show"),C(t,d,s,n)}),n.addEventListener("input",()=>{const l=n.value.toLowerCase(),h=d.filter(m=>m.name.toLowerCase().includes(l));C(t,h,s,n),t.classList.add("show")}),document.addEventListener("click",l=>{o.contains(l.target)||t.classList.remove("show")})}function C(e,a,o,n){e.innerHTML=a.slice(0,50).map(t=>`
        <div class="dropdown-item" data-value="${t.name}">
            <span style="color: var(--text-secondary); margin-right: 0.5rem;">#${t.rank}</span>
            ${t.name}
        </div>
    `).join(""),e.querySelectorAll(".dropdown-item").forEach(t=>{t.addEventListener("click",()=>{const s=t.dataset.value;o.value=s,n.value=s,e.classList.remove("show"),I(),T()})})}function v(e,a,o){const t=document.getElementById(e).querySelector(".search-input"),s=document.getElementById(a);s.value=o,t.value=o}function U(){document.getElementById("region-select").addEventListener("change",e=>{k=e.target.value,B()}),document.getElementById("start-year").addEventListener("change",e=>{g=parseInt(e.target.value),g>u&&(u=g,document.getElementById("end-year").value=u),B()}),document.getElementById("end-year").addEventListener("change",e=>{u=parseInt(e.target.value),u<g&&(g=u,document.getElementById("start-year").value=g),B()}),document.getElementById("historical-mode").addEventListener("change",e=>{j=e.target.checked,B()}),document.getElementById("conf-set").addEventListener("change",()=>{B()})}function B(){const e=document.getElementById("school-a").value,a=document.getElementById("school-b").value;F(),d.find(o=>o.name===e)&&v("select-a","school-a",e),d.find(o=>o.name===a)&&v("select-b","school-b",a),I()}function I(){const e=document.getElementById("school-a").value,a=document.getElementById("school-b").value;if(!e||!a||e===a){document.getElementById("comparison-chart-container").style.display="none",document.getElementById("comparison-summary").innerHTML="";return}const o=j?x:{},n=document.getElementById("conf-set")?.value||"csrankings",t=D(S,g,u,k,o,A,n),s=t.schools[e],l=t.schools[a];if(!s||!l){console.error("Could not find one of the schools");return}const h=new Set([...Object.keys(s.areas||{}),...Object.keys(l.areas||{})]),m=Array.from(h).sort((r,p)=>{const b=(s.areas[r]?.adjusted||0)+(l.areas[r]?.adjusted||0);return(s.areas[p]?.adjusted||0)+(l.areas[p]?.adjusted||0)-b}),E=m.map(r=>M[r]||r),i=m.map(r=>s.areas[r]?.adjusted||0),c=m.map(r=>l.areas[r]?.adjusted||0);document.getElementById("comparison-chart-container").style.display="block",L&&L.destroy();const f=document.getElementById("comparisonChart").getContext("2d");L=new y(f,{type:"bar",data:{labels:E,datasets:[{label:e,data:i,backgroundColor:"rgba(37, 99, 235, 0.7)",borderColor:"rgba(37, 99, 235, 1)",borderWidth:1},{label:a,data:c,backgroundColor:"rgba(16, 185, 129, 0.7)",borderColor:"rgba(16, 185, 129, 1)",borderWidth:1}]},options:{devicePixelRatio:3,indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{position:"nearest",xAlign:"left",yAlign:"center",caretSize:0,callbacks:{label:r=>`${r.dataset.label}: ${r.parsed.x.toFixed(1)} adjusted`}}},scales:{x:{beginAtZero:!0,title:{display:!0,text:"Adjusted Publication Count"}}}}}),V(e,a,m,i,c)}function V(e,a,o,n,t){const s=document.getElementById("comparison-summary");let l=0,h=0;const m=[],E=[];o.forEach((c,f)=>{const r=n[f],p=t[f],b=Math.abs(r-p),w=M[c]||c;r>p?(l++,b>.1&&m.push({area:w,margin:b.toFixed(1)})):p>r&&(h++,b>.1&&E.push({area:w,margin:b.toFixed(1)}))}),m.sort((c,f)=>parseFloat(f.margin)-parseFloat(c.margin)),E.sort((c,f)=>parseFloat(f.margin)-parseFloat(c.margin));let i=`
        <div class="summary-card" style="grid-column: 1 / -1; text-align: center;">
            <h4>Overall Comparison</h4>
            <div class="leader" style="font-size: 1.3rem;">
                <span style="color: rgba(37, 99, 235, 1);">${e}</span> leads in <strong>${l}</strong> areas
                &nbsp;|&nbsp;
                <span style="color: rgba(16, 185, 129, 1);">${a}</span> leads in <strong>${h}</strong> areas
            </div>
        </div>
    `;i+='<div style="grid-column: 1 / -1; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">',i+=`<div style="display: flex; flex-direction: column; gap: 0.75rem;">
        <h4 style="margin: 0; color: rgba(37, 99, 235, 1); font-weight: 600;">${e} Leads</h4>`,m.forEach(c=>{i+=`
            <div class="summary-card" style="border-left: 3px solid rgba(37, 99, 235, 1);">
                <h4>${c.area}</h4>
                <div class="margin" style="color: rgba(37, 99, 235, 1);">+${c.margin} adjusted pubs</div>
            </div>
        `}),i+="</div>",i+=`<div style="display: flex; flex-direction: column; gap: 0.75rem;">
        <h4 style="margin: 0; color: rgba(16, 185, 129, 1); font-weight: 600;">${a} Leads</h4>`,E.forEach(c=>{i+=`
            <div class="summary-card" style="border-left: 3px solid rgba(16, 185, 129, 1);">
                <h4>${c.area}</h4>
                <div class="margin" style="color: rgba(16, 185, 129, 1);">+${c.margin} adjusted pubs</div>
            </div>
        `}),i+="</div>",i+="</div>",s.innerHTML=i}W();
