import{f as B,p as $,l as L}from"./data-CHqNZ0Rv.js";/* empty css              */import h from"./auto-CPGI3frw.js";function P(){const t=document.documentElement.getAttribute("data-theme")==="dark";return{text:t?"#e0e0e0":"#666666",grid:t?"#3d4043":"#e5e7eb",title:t?"#ffffff":"#111111"}}function D(){const t=P();h.defaults.color=t.text,h.defaults.borderColor=t.grid,h.defaults.plugins.title.color=t.title,h.defaults.plugins.legend.labels.color=t.text,h.defaults.scale.ticks.color=t.text,h.defaults.scale.title.color=t.text}D();const T=new MutationObserver(t=>{t.forEach(a=>{a.attributeName==="data-theme"&&(D(),c==="schools"?x():c==="areas"?w():c==="faculty"&&k())})});T.observe(document.documentElement,{attributes:!0});const Y={ai:"AI",vision:"Computer Vision",mlmining:"Machine Learning",nlp:"NLP",inforet:"Info Retrieval",arch:"Architecture",sec:"Security",mod:"Databases",da:"Design Automation",bed:"Embedded Systems",hpc:"HPC",mobile:"Mobile",metrics:"Measurement",ops:"Operating Systems",plan:"Programming Languages",soft:"Software Engineering",comm:"Networks",graph:"Graphics",act:"Algorithms",crypt:"Cryptography",log:"Logic & Verification",bio:"Bioinformatics",ecom:"Econ & Computation",chi:"HCI",robotics:"Robotics",visualization:"Visualization",csed:"CS Education"};let g=[],E={},I={},u=null,c="schools",M=!1;async function O(){console.log("Initializing Analysis Dashboard...");try{const t="https://raw.githubusercontent.com/dynaroars/cspicks/main/public",[a,s,r]=await Promise.all([L(),fetch(`${t}/professor_history_openalex.json`).then(o=>o.ok?o.json():{}).catch(o=>({})),fetch(`${t}/school-aliases.json`).then(o=>o.ok?o.json():{}).catch(o=>({}))]);g=a,E=s,I=r,console.log("Data loaded:",g.length,"records, history for",Object.keys(E).length,"profs, aliases for",Object.keys(I).length,"schools"),H(),F(),z(),G(),x()}catch(t){console.error("Analysis load error:",t)}}function H(){const t=document.getElementById("analysis-school-select"),a=B(g,2020,2025,"us"),s=Object.keys(a.schools).sort();t.innerHTML=s.map(r=>`<option value="${r}" ${r==="George Mason University"?"selected":""}>${r}</option>`).join(""),t.addEventListener("change",()=>{c==="schools"?x():c==="areas"?w():c==="faculty"&&k()})}function F(){const t=document.getElementById("analysis-start-year"),a=document.getElementById("analysis-end-year"),s=new Date().getFullYear();for(let o=2e3;o<=s;o++)a.innerHTML+=`<option value="${o}" ${o===s?"selected":""}>${o}</option>`,t.innerHTML+=`<option value="${o}" ${o===s-10?"selected":""}>${o}</option>`;const r=()=>{c==="schools"?x():c==="areas"?w():c==="faculty"&&k()};t.addEventListener("change",r),a.addEventListener("change",r)}function z(){const t=document.getElementById("analysis-historical-mode");t&&t.addEventListener("change",()=>{M=t.checked,c==="schools"?x():c==="areas"?w():c==="faculty"&&k()})}function G(){document.querySelectorAll(".nav-tab").forEach(t=>{t.addEventListener("click",()=>{document.querySelectorAll(".nav-tab").forEach(s=>s.classList.remove("active")),t.classList.add("active"),document.querySelectorAll(".view-section").forEach(s=>s.style.display="none");const a=t.dataset.tab;c=a,a==="schools"?(document.getElementById("school-trends-view").style.display="block",x()):a==="areas"?(document.getElementById("area-growth-view").style.display="block",w()):a==="faculty"&&(document.getElementById("faculty-diversity-view").style.display="block",k())})})}async function x(){try{u&&u.destroy();const t=document.getElementById("rankingChart")?.getContext("2d");if(!t){console.error("Canvas rankingChart not found");return}const a=document.getElementById("analysis-school-select")?.value||"George Mason University",s=parseInt(document.getElementById("analysis-end-year")?.value)||new Date().getFullYear(),r=s-10,o=[],f=[],b="us";console.log("Calculating trends for",a,"from",r,"to",s);const A=s-r;for(let l=s-9;l<=s;l++){const p=Math.max(r,l-A),v=l,e=B({...g},p,v,b,M?E:null,M?I:null).schools[a];o.push(l),f.push(e?e.rank:null)}u=new h(t,{type:"line",data:{labels:o,datasets:[{label:`${a} (Rank in US)`,data:f,borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.2,fill:{target:"end",below:"rgba(16, 185, 129, 0.1)"},pointRadius:4,pointHoverRadius:6}]},options:{devicePixelRatio:2,responsive:!0,maintainAspectRatio:!1,scales:{y:{reverse:!0,title:{display:!0,text:"US Rank (10-year window)"},suggestedMin:1,suggestedMax:100}},plugins:{tooltip:{callbacks:{}}}}})}catch(t){console.error("Error rendering school trends:",t)}}function w(){u&&u.destroy();const t=document.getElementById("areaChart").getContext("2d"),a=[],s=new Date().getFullYear(),r=2010,o={};for(let e=r;e<=s;e++)a.push(e),o[e]={};if(!g||!g.professors){console.error("No rawData available for Area Trends");return}const f=document.getElementById("analysis-school-select")?.value||"George Mason University";Object.values(g.professors).filter(e=>e.affiliation===f).flatMap(e=>e.pubs).forEach(e=>{if(e.year>=r&&e.year<=s){let n=!0;if(E&&E[e.name]){const i=E[e.name].find(d=>e.year>=d.start&&e.year<=d.end);i?n=(I[i.school]||i.school)===f:n=!1}else M&&(n=!1);if(n){const i=$[e.area]||e.area;o[e.year][i]||(o[e.year][i]=0),o[e.year][i]+=e.adjustedcount}}});const l={};Object.values(o).forEach(e=>{Object.entries(e).forEach(([n,i])=>{l[n]=(l[n]||0)+i})});const v=Object.entries(l).sort(([,e],[,n])=>n-e).map(([e])=>e).map((e,n)=>{const i=a.map(C=>o[C][e]||0),d=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#6366f1","#14b8a6","#06b6d4","#f97316"];return{label:Y[e]||e,data:i,borderColor:d[n%d.length],backgroundColor:d[n%d.length],tension:.3,fill:!1,pointRadius:3,borderWidth:2}});u=new h(t,{type:"line",data:{labels:a,datasets:v},options:{devicePixelRatio:2,responsive:!0,maintainAspectRatio:!1,interaction:{mode:"nearest",axis:"x",intersect:!1},scales:{y:{title:{display:!0,text:"Adjusted Paper Count"},beginAtZero:!0}},plugins:{legend:{display:!1},title:{display:!0,text:`Top Research Areas Growth at ${f}`}}}});const y=document.getElementById("area-legend");y&&(y.innerHTML='<div style="font-weight: 600; margin-bottom: 0.5rem;">Areas</div>'+v.map((e,n)=>`
                <label style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; cursor: pointer;">
                    <input type="checkbox" checked data-index="${n}" style="accent-color: ${e.borderColor};">
                    <span style="width: 12px; height: 12px; background: ${e.borderColor}; border-radius: 2px;"></span>
                    <span>${e.label}</span>
                </label>
            `).join(""),y.querySelectorAll('input[type="checkbox"]').forEach(e=>{e.addEventListener("change",n=>{const i=parseInt(n.target.dataset.index);u.setDatasetVisibility(i,n.target.checked),u.update()})}))}function k(){u&&u.destroy();const t=document.getElementById("diversityChart").getContext("2d"),a=[],s=new Date().getFullYear(),r=2010,o=3,f=[],b=[],A=[];for(let l=r;l<=s;l++){a.push(l);const p=l-o+1,v=l,y={},e=document.getElementById("analysis-school-select")?.value||"George Mason University";Object.entries(g.professors).filter(([,m])=>m.affiliation===e).forEach(([m,R])=>{R.pubs.forEach(S=>{if(S.year>=p&&S.year<=v){y[m]||(y[m]=new Set);const j=$[S.area]||S.area;y[m].add(j)}})});let i=0;const d=Object.keys(y),C=d.length;C>0?(d.forEach(m=>{y[m].size>1&&i++}),f.push(i/C*100)):f.push(0),b.push(C),A.push(i)}u=new h(t,{type:"line",data:{labels:a,datasets:[{label:"% Multi-Area Faculty",data:f,borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.1)",tension:.3,fill:!0,pointRadius:4,yAxisID:"y"},{label:"Active Faculty Count",data:b,borderColor:"#f59e0b",backgroundColor:"rgba(245, 158, 11, 0.1)",tension:.3,fill:!1,pointRadius:3,borderDash:[5,5],yAxisID:"y1"}]},options:{devicePixelRatio:2,responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"% Multi-Area"},beginAtZero:!0,suggestedMax:60},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Faculty Count"},beginAtZero:!0,grid:{drawOnChartArea:!1}}},plugins:{tooltip:{callbacks:{afterBody:function(l){const p=l[0].dataIndex;return`Multi-Area: ${A[p]} of ${b[p]} faculty`}}},title:{display:!0,text:"Faculty publishing in 2+ research areas (3-year rolling window)"}}}})}O();
